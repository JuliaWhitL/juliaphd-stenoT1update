## Rules (Non-Negotiable)
- Use only R and write .R scripts
- You can use any R package that is available on CRAN
- Complete all tasks associated with this prompt
- Do NOT ask the user questions.
- Do NOT change unrelated code.
- Do NOT assume something is unimplemented â€” confirm by reading code.
- Implement completely; no placeholders or stubs.
- If No-commit is true, do NOT commit or push changes.
- Do NOT edit this file
- All changes made during the run must be committed (including updates to progress/logs).
- Before committing, perform a final security, performance, and regression review of your changes.

## Tasks

We have access to a set of training data called training-sample.csv. In the training data there is a
censored time to event outcome with competing risks encoded in the "time" and "event" columns.
The "time" column is the time in years since start until the first event, and the "event" indicator tells us
what type of event occurred at that time, 0 is censoring, 1 is our event of interest and 2 is the competing
event.

The goal is to create a prediction model for the probability that event 1 occurs within 5 years: P(time <= 5 & event == 1 | covariates) to include in our Superlearner library for the Steno risk engine update. The prediction model can be based on any or all of the other covariates in the training sample. The goal is to make as accurate a prediction model as possible that can be included in an ensemble of learners. You can use whatever methods you want, as long as it can be implemented in an R function.

### NOTE: SUBMITTING YOUR LEARNER ---
Your submission should be a fitted model object that can be passed directly to
riskRegression::Score(list("My Model" = your_fit_object), ...).
Score internally calls predictRisk() on the object, so your model class must
have a compatible predictRisk S3 method.

# Standard riskRegression models (e.g. CSC, FGR) handle this automatically.

For custom learners you must write a predictRisk S3 method for your model class.
This method must:
  - Accept arguments: object, newdata, times, cause, ...
  - Return a matrix of predicted risks with nrow = nrow(newdata) and ncol = length(times)
    # i.e., 1 row per person, 1 column per prediction horizon (5- and 10-year models can be created & assessed separately if preferred)
  - Predict cause-specific cumulative incidence

### Minimal example for a custom learner:
predictRisk.myModel <- function(object, newdata, times, cause, ...) {
   # generate predicted cumulative incidence at each time point for each row of newdata
   # return matrix: rows = observations, columns = time points
}

# Before submitting, verify with:
predictRisk(your_fit, newdata = play, times = c(5, 10), cause = 1)

riskRegression::Score(list("My Model" = your_fit), data = play,
 formula = Hist(time, event) ~ 1, times = c(5,10), cause = 1)

# or, for separate model/times combo...
riskRegression::Score(list("My Model" = your_fit5), data = play,
                       formula = Hist(time, event) ~ 1, times = 5, cause = 1)

 riskRegression::Score(list("My Model" = your_fit10), data = play,
                       formula = Hist(time, event) ~ 1, times = 10, cause = 1)


## INSTRUCTIONS
1) Read the file training-sample.csv
2) Construct & tune learners that predict the 5-year risk of CVD (event== 1) in
the presence of non-CVD death (event== 2). Event==0 indicates right censoring.
Optimal handling of outcome and covariates (number of splines, interactions, etc.) is dealer's choice.
3) Write an R script for the training process of the learners, and include a predictRisk method for the trained model
4) Write a separate R script that provides a cross-validated estimate of the performance of the model in terms of the Brier score, using only the training data.

5) Repeat for 10-year CVD risk

Tell me when you are done and provide me with your estimates of performance.

